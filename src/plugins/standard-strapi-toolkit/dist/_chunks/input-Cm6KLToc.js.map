{"version":3,"file":"input-Cm6KLToc.js","sources":["../../admin/src/fields/multi-select/react-select.tsx","../../admin/src/fields/multi-select/value-container.tsx","../../admin/src/fields/multi-select/input.tsx"],"sourcesContent":["import Select from 'react-select';\r\nimport styled from 'styled-components';\r\n\r\nconst SelectInput = ({ components, styles, error, ariaErrorMessage, ...props }: any) => {\r\n  return (\r\n    <Select\r\n      menuPosition=\"fixed\"\r\n      components={{\r\n        IndicatorSeparator: () => null,\r\n        LoadingIndicator: () => null,\r\n        ...components,\r\n      }}\r\n      aria-errormessage={error && ariaErrorMessage}\r\n      aria-invalid={!!error}\r\n      styles={{ ...styles }}\r\n      {...props}\r\n    />\r\n  );\r\n};\r\n\r\nconst ReactSelect = styled(SelectInput)`\r\n  .select-control {\r\n    height: auto;\r\n    background: ${({ theme }) => theme.colors.neutral0};\r\n    border: 1px solid ${({ theme }) => theme.colors.neutral200};\r\n\r\n    & > div:first-child {\r\n      padding: 4px;\r\n      gap: 4px;\r\n\r\n      & > div {\r\n        padding-left: 8px;\r\n      }\r\n    }\r\n\r\n    .select-multi-value-container {\r\n      margin-right: -8px;\r\n    }\r\n\r\n    & [aria-disabled='true'] {\r\n      background: ${({ theme }) => theme.colors.neutral150};\r\n      border: 1px solid ${({ theme }) => theme.colors.neutral200};\r\n    }\r\n  }\r\n  .select-menu {\r\n    background: ${({ theme }) => theme.colors.neutral0};\r\n\r\n    .option-focused {\r\n      background: ${({ theme }) => theme.colors.neutral200};\r\n    }\r\n  }\r\n`;\r\n\r\nexport default ReactSelect;\r\n","import { Tag } from '@strapi/design-system';\r\nimport { Cross } from '@strapi/icons';\r\n\r\nconst ValueContainer = ({\r\n  selectProps,\r\n  data,\r\n}: {\r\n  selectProps: any;\r\n  data: {\r\n    value: string;\r\n    label: string;\r\n  };\r\n}) => {\r\n  const handleTagClick = (data: { value: string; label: string }) => (e: React.UIEvent<any>) => {\r\n    e.preventDefault();\r\n    selectProps.onChange(selectProps.value.filter((v: any) => v !== data));\r\n  };\r\n  return (\r\n    <Tag tabIndex={-1} icon={<Cross />} onClick={handleTagClick(data)}>\r\n      {data.label}\r\n    </Tag>\r\n  );\r\n};\r\n\r\nexport default ValueContainer;\r\n","import React, { useMemo } from 'react';\r\nimport { Field, Flex } from '@strapi/design-system';\r\nimport ReactSelect from './react-select';\r\nimport { useField } from '@strapi/strapi/admin';\r\nimport { useIntl } from 'react-intl';\r\nimport ValueContainer from './value-container';\r\n\r\n\r\nconst Input = ({\r\n  hint,\r\n  label,\r\n  name,\r\n  intlLabel,\r\n  required,\r\n  attribute,\r\n  description,\r\n  placeholder,\r\n  disabled,\r\n}: {\r\n  hint: string;\r\n  label: string;\r\n  name: string;\r\n  intlLabel: any;\r\n  required: boolean;\r\n  attribute: any;\r\n  description: any;\r\n  placeholder: string;\r\n  disabled: boolean;\r\n}) => {\r\n  const { formatMessage } = useIntl();\r\n  const { onChange, value, error } = useField(name);\r\n\r\n  const possibleOptions = useMemo(() => {\r\n    return (attribute['options'] || [])\r\n      .map((option: string) => {\r\n        const [label, value] = [...option.split(/:(.*)/s), option];\r\n        if (!label || !value) return null;\r\n        return { label, value };\r\n      })\r\n      .filter(Boolean);\r\n  }, [attribute]);\r\n\r\n  const sanitizedValue = useMemo(() => {\r\n    let parsedValue;\r\n    try {\r\n      parsedValue = typeof value !== 'string' ? value || [] : JSON.parse(value || '[]');\r\n    } catch (e) {\r\n      parsedValue = [];\r\n    }\r\n    return Array.isArray(parsedValue)\r\n      ? parsedValue\r\n        .map((val) =>\r\n          possibleOptions.find((option: { label: string; value: string }) => option.value === val)\r\n        )\r\n        .filter((option) => !!option)\r\n      : [];\r\n  }, [value, possibleOptions]);\r\n\r\n  const fieldError = useMemo(() => {\r\n    if (error) return error;\r\n\r\n    const { min, max } = attribute;\r\n    const hasNoOptions = required && (!possibleOptions.length);\r\n    const belowMin = sanitizedValue.length < min && (required || sanitizedValue.length > 0);\r\n    const aboveMax = sanitizedValue.length > max;\r\n\r\n    if (hasNoOptions) {\r\n      return 'No options, but field is required';\r\n    }\r\n\r\n    if (belowMin) {\r\n      return `Select at least ${min} options`;\r\n    }\r\n\r\n    if (aboveMax) {\r\n      return `Select at most ${max} options`;\r\n    }\r\n\r\n    return null;\r\n  }, [required, error, possibleOptions, sanitizedValue, attribute]);\r\n\r\n  return (\r\n    <Field.Root\r\n      hint={description?.id ? formatMessage(description) : hint}\r\n      error={fieldError as string}\r\n      name={name}\r\n      required={required}\r\n    >\r\n      <Flex direction=\"column\" alignItems=\"stretch\" gap={1}>\r\n        <Field.Label>{intlLabel?.id ? formatMessage(intlLabel) : label}</Field.Label>\r\n        <ReactSelect\r\n          isSearchable={true}\r\n          isMulti={true}\r\n          error={fieldError}\r\n          name={name}\r\n          id={name}\r\n          isOptionDisabled={() => sanitizedValue.length >= attribute['max'] || false}\r\n          isDisabled={disabled || possibleOptions.length === 0}\r\n          placeholder={placeholder}\r\n          defaultValue={sanitizedValue.map((val: { label: string; value: string }) => ({\r\n            label: formatMessage({\r\n              id: val.label,\r\n              defaultMessage: val.label,\r\n            }),\r\n            value: val.value,\r\n          }))}\r\n          components={{\r\n            MultiValueContainer: ValueContainer,\r\n          }}\r\n          options={possibleOptions.map((option: { label: string; value: string }) => ({\r\n            ...option,\r\n            label: formatMessage({\r\n              id: option.label,\r\n              defaultMessage: option.label,\r\n            }),\r\n          }))}\r\n          onChange={(val: any) => {\r\n            onChange({\r\n              target: {\r\n                name: name,\r\n                value:\r\n                  val?.length && val.filter((v: any) => !!v)\r\n                    ? JSON.stringify(val.filter((v: any) => !!v).map((v: any) => v.value))\r\n                    : null,\r\n                type: attribute.type,\r\n              },\r\n            } as React.ChangeEvent<HTMLInputElement>);\r\n          }}\r\n          classNames={{\r\n            control: (_state: any) => 'select-control',\r\n            multiValue: (_state: any) => 'select-multi-value',\r\n            placeholder: (_state: any) => 'select-placeholder',\r\n            menuList: (_state: any) => 'select-listbox',\r\n            menu: (_state: any) => 'select-menu',\r\n            option: (state: any) => (state.isFocused ? 'option-focused' : 'option'),\r\n          }}\r\n        />\r\n        <Field.Hint />\r\n        <Field.Error />\r\n      </Flex>\r\n    </Field.Root>\r\n  );\r\n};\r\n\r\nexport default Input;\r\n"],"names":["jsx","Select","styled","data","Tag","Cross","useIntl","useField","useMemo","label","value","Field","Flex"],"mappings":"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"}